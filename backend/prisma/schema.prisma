generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

// --- KULLANICI VE ROL ---
model User {
  id        Int      @id @default(autoincrement())
  username  String   @unique
  email     String   @unique
  password  String
  
  // ðŸ’° Her yeni Ã¼yeye otomatik 100 TL bakiye
  balance   Float    @default(100.0) 
  
  createdAt DateTime @default(now())
  
  deliveries Delivery[]
  roles      Role[]     @relation("RoleToUser")
}

model Role {
  id    Int    @id @default(autoincrement())
  name  String @unique
  users User[] @relation("RoleToUser")
}

// --- UYGULAMA VE KATEGORÄ° ---
model App {
  id             Int      @id @default(autoincrement())
  name           String
  version        String
  description    String?
  apkDownloadUrl String?
  imageUrl       String?
  createdAt      DateTime @default(now())
  
  itemPackages   ItemPackage[]
  categories     Category[]    @relation("AppToCategory")
}

model Category {
  id   Int    @id @default(autoincrement())
  name String @unique
  apps App[]  @relation("AppToCategory")
}

// --- EÅžYA PAKETLERÄ° ---
model ItemPackage {
  id          Int      @id @default(autoincrement())
  name        String
  description String?
  
  // ðŸ’¸ ÃœrÃ¼n fiyatÄ±
  price       Float    
  
  appId       Int
  app         App      @relation(fields: [appId], references: [id], onDelete: Cascade)
  deliveries  Delivery[]
}

// --- SÄ°PARÄ°Åž / TESLÄ°MAT GEÃ‡MÄ°ÅžÄ° ---
model Delivery {
  id            Int      @id @default(autoincrement())
  gameUserId    String
  createdAt     DateTime @default(now())
  
  userId        Int
  itemPackageId Int
  
  itemPackage   ItemPackage @relation(fields: [itemPackageId], references: [id])
  user          User        @relation(fields: [userId], references: [id])
}